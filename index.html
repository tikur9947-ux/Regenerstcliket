<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Anatoly Coin</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --main-gold: #f39c12;
            --dark-bg: #0a0a0a;
            --panel-bg: #1c1c1c;
            --bronze: #cd7f32;
            --silver: #c0c0c0;
            --gold: #ffd700;
        }

        body {
            background-color: var(--dark-bg);
            color: white;
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            height: 100vh;
            overflow: hidden;
            user-select: none;
            -webkit-user-select: none;
        }

        #app {
            display: flex;
            flex-direction: column;
            height: 100%;
            width: 100%;
        }

        .screen {
            flex: 1;
            display: none;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            overflow-y: auto;
        }

        .active { display: flex; }

        .score-container {
            text-align: center;
            margin-top: 40px;
            position: relative;
        }

        .currency-label {
            color: #888;
            font-size: 18px;
            letter-spacing: 2px;
            text-transform: uppercase;
            cursor: pointer;
            transition: all 0.3s;
            padding: 10px 20px;
            border-radius: 10px;
        }

        .currency-label:hover {
            color: var(--main-gold);
            background: rgba(243, 156, 18, 0.1);
        }

        .balance-value {
            font-size: 48px;
            font-weight: bold;
            margin: 10px 0;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .coin-wrapper {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            margin: 20px 0;
        }

        .main-coin {
            width: 260px;
            height: 260px;
            background: radial-gradient(circle, var(--main-gold), #d35400);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 120px;
            font-weight: bold;
            border: 10px solid #e67e22;
            box-shadow: 0 0 40px rgba(243, 156, 18, 0.4);
            cursor: pointer;
            transition: transform 0.05s;
            touch-action: manipulation;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
            position: relative;
            overflow: hidden;
        }

        .main-coin:active {
            transform: scale(0.92);
        }

        .coin-effect {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            pointer-events: none;
        }

        .energy-section {
            width: 100%;
            max-width: 300px;
            margin-bottom: 20px;
        }

        .energy-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-size: 14px;
        }

        .energy-bar {
            width: 100%;
            height: 12px;
            background: #333;
            border-radius: 6px;
            overflow: hidden;
        }

        #energy-fill {
            height: 100%;
            background: linear-gradient(90deg, #f1c40f, #f39c12);
            width: 100%;
            transition: width 0.2s;
        }

        .menu-list {
            width: 100%;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .menu-item {
            background: var(--panel-bg);
            padding: 15px;
            border-radius: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.2s;
        }

        .menu-item:active { 
            opacity: 0.8; 
            transform: scale(0.98);
        }
        
        .menu-item:hover {
            border-color: var(--main-gold);
        }
        
        .item-info h4 { margin: 0; font-size: 16px; }
        .item-info p { margin: 5px 0 0; color: #aaa; font-size: 13px; }
        .price { color: var(--main-gold); font-weight: bold; }

        .nav-bar {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 90%;
            background: rgba(28, 28, 28, 0.95);
            backdrop-filter: blur(10px);
            display: flex;
            justify-content: space-around;
            padding: 12px;
            border-radius: 20px;
            border: 1px solid #333;
        }

        .nav-btn {
            background: none;
            border: none;
            color: #666;
            font-size: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            cursor: pointer;
            padding: 8px 15px;
            border-radius: 10px;
            transition: all 0.2s;
        }

        .nav-btn.active-nav { 
            color: white; 
            background: rgba(243, 156, 18, 0.2);
        }
        
        .nav-btn:active {
            transform: scale(0.95);
        }

        .tap-number {
            position: absolute;
            color: white;
            font-size: 24px;
            font-weight: bold;
            pointer-events: none;
            animation: floatUp 0.8s ease-out forwards;
            z-index: 100;
        }

        @keyframes floatUp {
            0% { opacity: 1; transform: translateY(0); }
            100% { opacity: 0; transform: translateY(-120px); }
        }
        
        .save-notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(46, 204, 113, 0.9);
            color: white;
            padding: 10px 15px;
            border-radius: 10px;
            font-size: 14px;
            z-index: 1000;
            animation: slideIn 0.3s ease, fadeOut 0.3s ease 1.7s forwards;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes fadeOut {
            to { opacity: 0; }
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è —Ä–∞–∑–¥–µ–ª–∞ –¢–æ–ø—ã */
        .leaderboard {
            width: 100%;
            max-width: 400px;
            margin-top: 20px;
        }
        
        .leaderboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .refresh-btn {
            background: var(--main-gold);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 12px;
            cursor: pointer;
        }
        
        .leaderboard-item {
            display: flex;
            align-items: center;
            background: var(--panel-bg);
            padding: 12px 15px;
            border-radius: 10px;
            margin-bottom: 8px;
            transition: transform 0.2s;
        }
        
        .leaderboard-item:hover {
            transform: translateX(5px);
        }
        
        .rank {
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            font-weight: bold;
            margin-right: 15px;
        }
        
        .rank-1 { background: var(--gold); color: #000; }
        .rank-2 { background: var(--silver); color: #000; }
        .rank-3 { background: var(--bronze); color: #000; }
        .rank-other { background: #333; color: white; }
        
        .player-info {
            flex: 1;
        }
        
        .player-name {
            font-weight: bold;
            font-size: 14px;
        }
        
        .player-score {
            color: var(--main-gold);
            font-weight: bold;
            font-size: 16px;
        }
        
        .player-avatar {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background: linear-gradient(45deg, #667eea, #764ba2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-left: 10px;
        }
        
        .referral-section {
            background: linear-gradient(45deg, #1a2980, #26d0ce);
            padding: 15px;
            border-radius: 12px;
            margin-top: 20px;
            width: 100%;
            max-width: 400px;
        }
        
        .referral-code {
            background: rgba(255,255,255,0.1);
            padding: 10px;
            border-radius: 8px;
            font-family: monospace;
            text-align: center;
            margin: 10px 0;
            cursor: pointer;
            word-break: break-all;
        }
        
        .referral-code:active {
            background: rgba(255,255,255,0.2);
        }
        
        .daily-reward {
            background: linear-gradient(45deg, #f46b45, #eea849);
            padding: 15px;
            border-radius: 12px;
            margin-top: 15px;
            width: 100%;
            max-width: 400px;
            text-align: center;
        }
        
        .reward-btn {
            background: white;
            color: #f46b45;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            font-weight: bold;
            font-size: 16px;
            margin-top: 10px;
            cursor: pointer;
        }
        
        .reward-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .reward-timer {
            font-size: 12px;
            color: rgba(255,255,255,0.8);
            margin-top: 8px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            width: 100%;
            max-width: 400px;
            margin-top: 20px;
        }
        
        .stat-card {
            background: var(--panel-bg);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 20px;
            font-weight: bold;
            color: var(--main-gold);
        }
        
        .stat-label {
            font-size: 12px;
            color: #888;
            margin-top: 5px;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ */
        .admin-panel {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--panel-bg);
            border: 2px solid var(--main-gold);
            border-radius: 15px;
            padding: 25px;
            width: 90%;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
            z-index: 1000;
            box-shadow: 0 0 30px rgba(243, 156, 18, 0.3);
            display: none;
        }
        
        .admin-panel.active {
            display: block;
        }
        
        .admin-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 999;
            display: none;
        }
        
        .admin-overlay.active {
            display: block;
        }
        
        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .admin-close {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
        }
        
        .admin-input-group {
            margin-bottom: 15px;
        }
        
        .admin-input {
            width: 100%;
            padding: 12px;
            border-radius: 8px;
            border: 1px solid #444;
            background: #2a2a2a;
            color: white;
            font-size: 16px;
            margin-bottom: 10px;
        }
        
        .admin-btn {
            width: 100%;
            padding: 14px;
            background: linear-gradient(45deg, #27ae60, #2ecc71);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 10px;
        }
        
        .admin-btn:hover {
            background: linear-gradient(45deg, #229954, #27ae60);
        }
        
        .admin-btns-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 20px;
        }
        
        .admin-btn-small {
            padding: 10px;
            background: var(--main-gold);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
        }
        
        .admin-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #e74c3c;
            color: white;
            font-size: 10px;
            padding: 3px 8px;
            border-radius: 10px;
            font-weight: bold;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–æ–¥–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ */
        .code-modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--panel-bg);
            border: 2px solid #3498db;
            border-radius: 15px;
            padding: 25px;
            width: 90%;
            max-width: 350px;
            z-index: 1001;
            box-shadow: 0 0 30px rgba(52, 152, 219, 0.3);
            display: none;
        }
        
        .code-modal.active {
            display: block;
        }
        
        .code-input {
            width: 100%;
            padding: 12px;
            border-radius: 8px;
            border: 2px solid #3498db;
            background: #2a2a2a;
            color: white;
            font-size: 18px;
            text-align: center;
            letter-spacing: 2px;
            margin: 20px 0;
        }
        
        .code-submit {
            width: 100%;
            padding: 14px;
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
        }
        
        /* –ö–Ω–æ–ø–∫–∞ –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –∞–¥–º–∏–Ω–∫–µ */
        .quick-admin-btn {
            position: fixed;
            top: 10px;
            right: 10px;
            background: #e74c3c;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            cursor: pointer;
            z-index: 100;
            box-shadow: 0 4px 15px rgba(231, 76, 60, 0.3);
        }
        
        .quick-admin-btn:active {
            transform: scale(0.95);
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –º–∞–≥–∞–∑–∏–Ω–∞ —Å–∫–∏–Ω–æ–≤ */
        .skins-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            width: 100%;
            max-width: 400px;
            margin-top: 20px;
        }
        
        .skin-card {
            background: var(--panel-bg);
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            border: 3px solid transparent;
            position: relative;
            overflow: hidden;
        }
        
        .skin-card:hover {
            transform: translateY(-5px);
        }
        
        .skin-card.equipped {
            border-color: var(--main-gold);
            box-shadow: 0 0 20px rgba(243, 156, 18, 0.3);
        }
        
        .skin-card.locked {
            opacity: 0.6;
            filter: grayscale(0.8);
        }
        
        .skin-card.locked:before {
            content: 'üîí';
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 20px;
            z-index: 2;
        }
        
        .skin-preview {
            width: 100px;
            height: 100px;
            margin: 0 auto 10px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .skin-name {
            font-weight: bold;
            margin-bottom: 5px;
            font-size: 16px;
        }
        
        .skin-price {
            color: var(--main-gold);
            font-weight: bold;
            font-size: 18px;
        }
        
        .skin-owned {
            color: #2ecc71;
            font-weight: bold;
            font-size: 14px;
        }
        
        .skin-bonus {
            font-size: 12px;
            color: #888;
            margin-top: 5px;
        }
        
        /* –≠—Ñ—Ñ–µ–∫—Ç—ã –¥–ª—è —Å–∫–∏–Ω–æ–≤ */
        .skin-effect-glow {
            animation: glow 2s infinite alternate;
        }
        
        .skin-effect-rotate {
            animation: rotate 10s infinite linear;
        }
        
        .skin-effect-pulse {
            animation: pulse 1.5s infinite;
        }
        
        .skin-effect-rainbow {
            background: linear-gradient(45deg, 
                #ff0000, #ff9900, #ffff00, 
                #00ff00, #0099ff, #6633ff);
            background-size: 400% 400%;
            animation: rainbow 3s infinite linear;
        }
        
        @keyframes glow {
            from { box-shadow: 0 0 20px rgba(243, 156, 18, 0.5); }
            to { box-shadow: 0 0 40px rgba(243, 156, 18, 0.8); }
        }
        
        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        @keyframes rainbow {
            0% { background-position: 0% 50%; }
            100% { background-position: 100% 50%; }
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è —Ç–∞–±–æ–≤ */
        .shop-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            width: 100%;
            max-width: 400px;
        }
        
        .shop-tab {
            flex: 1;
            padding: 12px;
            text-align: center;
            background: var(--panel-bg);
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.2s;
        }
        
        .shop-tab.active {
            background: var(--main-gold);
            color: white;
        }
        
        .skin-info-panel {
            background: var(--panel-bg);
            padding: 15px;
            border-radius: 12px;
            margin-top: 20px;
            width: 100%;
            max-width: 400px;
            text-align: center;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ –∏–≥—Ä–æ–∫–æ–≤ */
        .admin-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            width: 100%;
        }
        
        .admin-tab {
            flex: 1;
            padding: 10px;
            text-align: center;
            background: var(--panel-bg);
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.2s;
        }
        
        .admin-tab.active {
            background: var(--main-gold);
            color: white;
        }
        
        .players-list {
            max-height: 300px;
            overflow-y: auto;
            margin-bottom: 20px;
            border: 1px solid #444;
            border-radius: 10px;
            padding: 10px;
        }
        
        .player-admin-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: #2a2a2a;
            border-radius: 8px;
            margin-bottom: 8px;
        }
        
        .player-admin-info {
            flex: 1;
        }
        
        .player-admin-name {
            font-weight: bold;
            font-size: 14px;
        }
        
        .player-admin-balance {
            color: var(--main-gold);
            font-size: 12px;
        }
        
        .player-admin-actions {
            display: flex;
            gap: 5px;
        }
        
        .admin-action-btn {
            padding: 5px 10px;
            background: var(--main-gold);
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 12px;
            cursor: pointer;
        }
        
        .skin-admin-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            max-height: 300px;
            overflow-y: auto;
            margin-bottom: 20px;
        }
        
        .skin-admin-card {
            background: var(--panel-bg);
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
        }
        
        .skin-admin-preview {
            width: 60px;
            height: 60px;
            margin: 0 auto 5px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }
        
        .search-input {
            width: 100%;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #444;
            background: #2a2a2a;
            color: white;
            margin-bottom: 15px;
        }
        
        .stats-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 12px;
        }
        
        .stats-label {
            color: #888;
        }
        
        .stats-value {
            color: var(--main-gold);
            font-weight: bold;
        }
    </style>
</head>
<body>

<!-- –ö–Ω–æ–ø–∫–∞ –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –∞–¥–º–∏–Ω–∫–µ -->
<button class="quick-admin-btn" onclick="showAdminCodeModal()">ADMIN</button>

<div id="app">
    <div id="main-screen" class="screen active">
        <div class="score-container">
            <div class="currency-label" onclick="showAdminCodeModal()">–í–ê–õ–Æ–¢–ê –ê–ù–ê–¢–û–õ–ò–ô</div>
            <div class="balance-value" id="balance">0</div>
        </div>

        <div class="coin-wrapper">
            <div class="main-coin" id="coin" onclick="handleCoinClick(event)">
                <div id="coin-effect" class="coin-effect"></div>
                <span id="coin-letter">–ê</span>
            </div>
        </div>

        <div class="energy-section">
            <div class="energy-info">
                <span>‚ö° –≠–Ω–µ—Ä–≥–∏—è</span>
                <span id="energy-text">1000 / 1000</span>
            </div>
            <div class="energy-bar">
                <div id="energy-fill"></div>
            </div>
        </div>
    </div>

    <div id="boosts-screen" class="screen">
        <h2>–ú–∞–≥–∞–∑–∏–Ω –ë—É—Å—Ç–æ–≤</h2>
        <div class="shop-tabs">
            <div class="shop-tab active" onclick="showShopTab('boosts')">üöÄ –ë—É—Å—Ç—ã</div>
            <div class="shop-tab" onclick="showShopTab('skins')">üé® –°–∫–∏–Ω—ã</div>
        </div>
        
        <div id="boosts-tab" class="shop-tab-content">
            <div class="menu-list">
                <div class="menu-item" onclick="buyMultitap()">
                    <div class="item-info">
                        <h4>Multitap</h4>
                        <p>+1 –∫ –∫–ª–∏–∫—É</p>
                    </div>
                    <div class="price" id="multitap-price">100</div>
                </div>
                <div class="menu-item" onclick="buyEnergyLimit()">
                    <div class="item-info">
                        <h4>Energy Limit</h4>
                        <p>+500 –∫ –º–∞–∫—Å. —ç–Ω–µ—Ä–≥–∏–∏</p>
                    </div>
                    <div class="price" id="energy-price">500</div>
                </div>
                <div class="menu-item" onclick="buyAutoClicker()">
                    <div class="item-info">
                        <h4>Auto Clicker</h4>
                        <p>–ê–≤—Ç–æ-–∫–ª–∏–∫ 1/—Å–µ–∫</p>
                    </div>
                    <div class="price" id="autoclicker-price">2000</div>
                </div>
            </div>
        </div>
        
        <div id="skins-tab" class="shop-tab-content" style="display: none;">
            <div class="skin-info-panel">
                <p>–¢–µ–∫—É—â–∏–π —Å–∫–∏–Ω: <span id="current-skin-name">–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π</span></p>
                <p>–ë–æ–Ω—É—Å: <span id="current-skin-bonus">+0% –∫ –¥–æ—Ö–æ–¥—É</span></p>
            </div>
            <div class="skins-grid" id="skins-grid">
                <!-- –°–∫–∏–Ω—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
            </div>
        </div>
    </div>

    <div id="tasks-screen" class="screen">
        <h2>–ó–∞–¥–∞–Ω–∏—è</h2>
        <div class="menu-list">
            <div class="menu-item" onclick="completeTask(1000, this, 'https://t.me/podilcliker')">
                <div class="item-info">
                    <h4>–ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ Podil Cliker</h4>
                    <p>–í—Å—Ç—É–ø–∏ –≤ –≥—Ä—É–ø–ø—É –∏ –ø–æ–ª—É—á–∏ –±–æ–Ω—É—Å</p>
                </div>
                <div class="price">+1000 –ê–Ω–∞—Ç–æ–ª–∏–π</div>
            </div>
            <div class="menu-item" onclick="completeTask(500, this)">
                <div class="item-info">
                    <h4>100 —Ç–∞–ø–æ–≤ –∑–∞ –¥–µ–Ω—å</h4>
                    <p id="taps-progress">–ü—Ä–æ–≥—Ä–µ—Å—Å: 0/100</p>
                </div>
                <div class="price">+500 –ê–Ω–∞—Ç–æ–ª–∏–π</div>
            </div>
            <div class="menu-item" onclick="completeTask(2000, this)">
                <div class="item-info">
                    <h4>–ü—Ä–∏–≥–ª–∞—Å–∏ –¥—Ä—É–≥–∞</h4>
                    <p>–î—Ä—É–≥ –ø–æ–ª—É—á–∏—Ç –±–æ–Ω—É—Å 1000 –º–æ–Ω–µ—Ç</p>
                </div>
                <div class="price">+2000 –ê–Ω–∞—Ç–æ–ª–∏–π</div>
            </div>
        </div>
    </div>

    <div id="top-screen" class="screen">
        <h2>üèÜ –¢–æ–ø –ò–≥—Ä–æ–∫–æ–≤</h2>
        
        <div class="leaderboard">
            <div class="leaderboard-header">
                <h3 style="margin: 0;">–ì–ª–æ–±–∞–ª—å–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥</h3>
                <button class="refresh-btn" onclick="loadRealLeaderboard()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
            </div>
            
            <div id="leaderboard-list">
                <div style="text-align: center; padding: 20px; color: #888;">
                    –ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Ç–æ–ø–∞ –∏–≥—Ä–æ–∫–æ–≤...
                </div>
            </div>
        </div>
        
        <div class="referral-section">
            <h4 style="margin: 0 0 10px 0;">üë• –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞</h4>
            <p style="font-size: 12px; margin: 0 0 10px 0;">–ü—Ä–∏–≥–ª–∞—Å–∏ –¥—Ä—É–≥–∞ –ø–æ —Å—Å—ã–ª–∫–µ –∏ –ø–æ–ª—É—á–∞–π 10% –æ—Ç –µ–≥–æ –¥–æ—Ö–æ–¥–∞!</p>
            <div class="referral-code" onclick="copyReferralCode()" id="referral-code">
                –ó–∞–≥—Ä—É–∑–∫–∞...
            </div>
            <p style="font-size: 11px; color: rgba(255,255,255,0.7); margin: 5px 0 0 0;">
                –ü—Ä–∏–≥–ª–∞—à–µ–Ω–æ –¥—Ä—É–∑–µ–π: <span id="referral-count">0</span>
            </p>
        </div>
        
        <div class="daily-reward">
            <h4 style="margin: 0 0 10px 0;">üéÅ –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è –Ω–∞–≥—Ä–∞–¥–∞</h4>
            <p style="font-size: 14px; margin: 0 0 10px 0;">–ó–∞–π–¥–∏ –∑–∞–≤—Ç—Ä–∞ –∏ –ø–æ–ª—É—á–∏ –±–æ–Ω—É—Å!</p>
            <button class="reward-btn" onclick="claimDailyReward()" id="daily-reward-btn">
                –ó–∞–±—Ä–∞—Ç—å –Ω–∞–≥—Ä–∞–¥—É
            </button>
            <div class="reward-timer" id="reward-timer"></div>
        </div>
        
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-value" id="total-taps">0</div>
                <div class="stat-label">–í—Å–µ–≥–æ —Ç–∞–ø–æ–≤</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="total-boosts">0</div>
                <div class="stat-label">–ö—É–ø–ª–µ–Ω–æ –±—É—Å—Ç–æ–≤</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="session-earned">0</div>
                <div class="stat-label">–ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ –∑–∞ —Å–µ—Å—Å–∏—é</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="player-rank">#-</div>
                <div class="stat-label">–í–∞—à —Ä–∞–Ω–≥</div>
            </div>
        </div>
    </div>

    <nav class="nav-bar">
        <div class="nav-btn active-nav" onclick="showScreen('main-screen', this)">
            <span>üîò</span><span>–¢–∞–ø</span>
        </div>
        <div class="nav-btn" onclick="showScreen('tasks-screen', this)">
            <span>üìã</span><span>–ó–∞–¥–∞–Ω–∏—è</span>
        </div>
        <div class="nav-btn" onclick="showScreen('boosts-screen', this)">
            <span>üöÄ</span><span>–ë—É—Å—Ç—ã</span>
        </div>
        <div class="nav-btn" onclick="showScreen('top-screen', this)">
            <span>üèÜ</span><span>–¢–æ–ø—ã</span>
        </div>
    </nav>
</div>

<!-- –û–≤–µ—Ä–ª–µ–π –¥–ª—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω -->
<div class="admin-overlay" id="adminOverlay" onclick="closeAdminPanel()"></div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –≤–≤–æ–¥–∞ –∫–æ–¥–∞ –∞–¥–º–∏–Ω–∞ -->
<div class="code-modal" id="codeModal">
    <h2 style="text-align: center; margin: 0 0 15px 0;">üîê –ê–∫—Ç–∏–≤–∞—Ü–∏—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏</h2>
    <p style="text-align: center; color: #aaa; font-size: 14px; margin-bottom: 10px;">
        –í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
    </p>
    <input type="text" class="code-input" id="adminCodeInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥..." maxlength="20">
    <button class="code-submit" onclick="checkAdminCode()">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
</div>

<!-- –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ -->
<div class="admin-panel" id="adminPanel">
    <div class="admin-header">
        <h2 style="margin: 0;">‚öôÔ∏è –ü–∞–Ω–µ–ª—å –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h2>
        <button class="admin-close" onclick="closeAdminPanel()">√ó</button>
    </div>
    
    <div class="admin-tabs">
        <div class="admin-tab active" onclick="showAdminTab('main')">–û—Å–Ω–æ–≤–Ω–æ–µ</div>
        <div class="admin-tab" onclick="showAdminTab('players')">–ò–≥—Ä–æ–∫–∏</div>
        <div class="admin-tab" onclick="showAdminTab('skins')">–°–∫–∏–Ω—ã</div>
    </div>
    
    <!-- –û—Å–Ω–æ–≤–Ω–∞—è –≤–∫–ª–∞–¥–∫–∞ -->
    <div id="admin-tab-main" class="admin-tab-content">
        <div class="admin-input-group">
            <input type="number" class="admin-input" id="adminCoinsAmount" placeholder="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–æ–Ω–µ—Ç">
            <button class="admin-btn" onclick="addAdminCoins()">–î–æ–±–∞–≤–∏—Ç—å –º–æ–Ω–µ—Ç—ã</button>
        </div>
        
        <div class="admin-btns-grid">
            <button class="admin-btn-small" onclick="addCoins(1000)">+1,000</button>
            <button class="admin-btn-small" onclick="addCoins(10000)">+10,000</button>
            <button class="admin-btn-small" onclick="addCoins(100000)">+100,000</button>
            <button class="admin-btn-small" onclick="addCoins(1000000)">+1,000,000</button>
        </div>
        
        <div style="margin-top: 20px; border-top: 1px solid #444; padding-top: 15px;">
            <button class="admin-btn" onclick="resetEnergy()" style="background: linear-gradient(45deg, #3498db, #2980b9);">
                ‚ôªÔ∏è –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —ç–Ω–µ—Ä–≥–∏—é
            </button>
            <button class="admin-btn" onclick="resetGame()" style="background: linear-gradient(45deg, #e74c3c, #c0392b); margin-top: 10px;">
                üóëÔ∏è –°–±—Ä–æ—Å–∏—Ç—å –∏–≥—Ä—É
            </button>
        </div>
        
        <div style="margin-top: 15px; font-size: 12px; color: #888; text-align: center;">
            –¢–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å: <span id="currentBalanceAdmin">0</span> –º–æ–Ω–µ—Ç
        </div>
    </div>
    
    <!-- –í–∫–ª–∞–¥–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–≥—Ä–æ–∫–∞–º–∏ -->
    <div id="admin-tab-players" class="admin-tab-content" style="display: none;">
        <input type="text" class="search-input" id="playerSearch" placeholder="–ü–æ–∏—Å–∫ –∏–≥—Ä–æ–∫–∞..." onkeyup="searchPlayers()">
        
        <div class="players-list" id="players-list">
            <!-- –°–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω –∑–¥–µ—Å—å -->
        </div>
        
        <div class="admin-input-group">
            <input type="text" class="admin-input" id="playerIdInput" placeholder="ID –∏–≥—Ä–æ–∫–∞">
            <input type="number" class="admin-input" id="playerCoinsAmount" placeholder="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–æ–Ω–µ—Ç">
            <button class="admin-btn" onclick="giveCoinsToPlayer()">–í—ã–¥–∞—Ç—å –º–æ–Ω–µ—Ç—ã –∏–≥—Ä–æ–∫—É</button>
        </div>
        
        <div class="stats-row">
            <div class="stats-label">–í—Å–µ–≥–æ –∏–≥—Ä–æ–∫–æ–≤:</div>
            <div class="stats-value" id="total-players">0</div>
        </div>
        <div class="stats-row">
            <div class="stats-label">–û–±—â–∏–π –±–∞–ª–∞–Ω—Å –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤:</div>
            <div class="stats-value" id="total-balance">0</div>
        </div>
    </div>
    
    <!-- –í–∫–ª–∞–¥–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∫–∏–Ω–∞–º–∏ -->
    <div id="admin-tab-skins" class="admin-tab-content" style="display: none;">
        <div class="skin-admin-grid" id="admin-skins-grid">
            <!-- –°–∫–∏–Ω—ã –¥–ª—è –∞–¥–º–∏–Ω–∞ -->
        </div>
        
        <div class="admin-input-group">
            <input type="text" class="admin-input" id="skinPlayerId" placeholder="ID –∏–≥—Ä–æ–∫–∞">
            <select class="admin-input" id="skinSelect">
                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Å–∫–∏–Ω</option>
                <!-- –°–∫–∏–Ω—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JS -->
            </select>
            <button class="admin-btn" onclick="giveSkinToPlayer()">–í—ã–¥–∞—Ç—å —Å–∫–∏–Ω –∏–≥—Ä–æ–∫—É</button>
        </div>
        
        <button class="admin-btn" onclick="unlockAllSkins()" style="background: linear-gradient(45deg, #9b59b6, #8e44ad);">
            üîì –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Å–∫–∏–Ω—ã —Å–µ–±–µ
        </button>
    </div>
</div>

<script>
// ===== –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï =====
let gameState = null;
const tg = window.Telegram.WebApp;
let allPlayers = {}; // –•—Ä–∞–Ω–∏–ª–∏—â–µ –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤
let leaderboardData = []; // –î–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Ç–æ–ø–∞

// ===== –°–ò–°–¢–ï–ú–ê –°–ö–ò–ù–û–í =====
const skinsData = [
    {
        id: 'classic',
        name: '–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π',
        price: 0,
        bonus: 0,
        color1: '#f39c12',
        color2: '#d35400',
        borderColor: '#e67e22',
        letter: '–ê',
        effect: 'none',
        owned: true,
        equipped: true
    },
    {
        id: 'gold',
        name: '–ó–æ–ª–æ—Ç–æ–π',
        price: 5000,
        bonus: 10,
        color1: '#ffd700',
        color2: '#ff9900',
        borderColor: '#ffcc00',
        letter: 'üí∞',
        effect: 'glow',
        owned: false,
        equipped: false
    },
    {
        id: 'diamond',
        name: '–ë—Ä–∏–ª–ª–∏–∞–Ω—Ç–æ–≤—ã–π',
        price: 15000,
        bonus: 25,
        color1: '#00ffff',
        color2: '#0099cc',
        borderColor: '#00ccff',
        letter: 'üíé',
        effect: 'pulse',
        owned: false,
        equipped: false
    },
    {
        id: 'ruby',
        name: '–†—É–±–∏–Ω–æ–≤—ã–π',
        price: 10000,
        bonus: 20,
        color1: '#ff3366',
        color2: '#cc0033',
        borderColor: '#ff0066',
        letter: '‚ù§Ô∏è',
        effect: 'pulse',
        owned: false,
        equipped: false
    },
    {
        id: 'emerald',
        name: '–ò–∑—É–º—Ä—É–¥–Ω—ã–π',
        price: 12000,
        bonus: 22,
        color1: '#00ff99',
        color2: '#009966',
        borderColor: '#00cc99',
        letter: 'üíö',
        effect: 'glow',
        owned: false,
        equipped: false
    },
    {
        id: 'galaxy',
        name: '–ì–∞–ª–∞–∫—Ç–∏–∫–∞',
        price: 25000,
        bonus: 35,
        color1: '#6633ff',
        color2: '#3300cc',
        borderColor: '#6600ff',
        letter: 'üåå',
        effect: 'rainbow',
        owned: false,
        equipped: false
    },
    {
        id: 'fire',
        name: '–û–≥–Ω–µ–Ω–Ω—ã–π',
        price: 8000,
        bonus: 18,
        color1: '#ff3300',
        color2: '#cc0000',
        borderColor: '#ff6600',
        letter: 'üî•',
        effect: 'glow',
        owned: false,
        equipped: false
    },
    {
        id: 'ice',
        name: '–õ–µ–¥—è–Ω–æ–π',
        price: 9000,
        bonus: 19,
        color1: '#66ffff',
        color2: '#3399ff',
        borderColor: '#00ccff',
        letter: '‚ùÑÔ∏è',
        effect: 'pulse',
        owned: false,
        equipped: false
    },
    {
        id: 'platinum',
        name: '–ü–ª–∞—Ç–∏–Ω–æ–≤—ã–π',
        price: 30000,
        bonus: 40,
        color1: '#e5e5e5',
        color2: '#999999',
        borderColor: '#cccccc',
        letter: '‚ö™',
        effect: 'glow',
        owned: false,
        equipped: false
    },
    {
        id: 'rainbow',
        name: '–†–∞–¥—É–∂–Ω—ã–π',
        price: 50000,
        bonus: 50,
        color1: 'linear-gradient(45deg, #ff0000, #ff9900, #ffff00, #00ff00, #0099ff, #6633ff)',
        color2: 'linear-gradient(45deg, #cc0000, #cc6600, #cccc00, #00cc00, #0066cc, #3300cc)',
        borderColor: '#ffffff',
        letter: 'üåà',
        effect: 'rainbow',
        owned: false,
        equipped: false
    },
    {
        id: 'space',
        name: '–ö–æ—Å–º–∏—á–µ—Å–∫–∏–π',
        price: 40000,
        bonus: 45,
        color1: '#000033',
        color2: '#000066',
        borderColor: '#6600ff',
        letter: 'üöÄ',
        effect: 'rotate',
        owned: false,
        equipped: false
    },
    {
        id: 'ancient',
        name: '–î—Ä–µ–≤–Ω–∏–π',
        price: 20000,
        bonus: 30,
        color1: '#996633',
        color2: '#663300',
        borderColor: '#cc6600',
        letter: 'üè∫',
        effect: 'glow',
        owned: false,
        equipped: false
    }
];

// ===== –°–ò–°–¢–ï–ú–ê –•–†–ê–ù–ï–ù–ò–Ø –í–°–ï–• –ò–ì–†–û–ö–û–í =====
const PLAYERS_STORAGE_KEY = 'anatoly_coin_all_players';

function saveAllPlayers() {
    try {
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â–µ–≥–æ –∏–≥—Ä–æ–∫–∞ –≤ –æ–±—â–µ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
        if (gameState) {
            const userId = getUserId();
            allPlayers[userId] = {
                id: userId,
                username: getUserName(),
                balance: gameState.balance,
                totalEarned: gameState.totalEarned,
                totalTaps: gameState.totalTaps,
                lastActive: Date.now(),
                skins: gameState.skins,
                isAdmin: gameState.isAdmin,
                referralCode: gameState.referralCode,
                referrals: gameState.referrals
            };
        }
        
        const playersData = JSON.stringify(allPlayers);
        localStorage.setItem(PLAYERS_STORAGE_KEY, playersData);
        return true;
    } catch (error) {
        console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–≥—Ä–æ–∫–æ–≤:', error);
        return false;
    }
}

function loadAllPlayers() {
    try {
        const saved = localStorage.getItem(PLAYERS_STORAGE_KEY);
        if (saved) {
            allPlayers = JSON.parse(saved);
            console.log('–ó–∞–≥—Ä—É–∂–µ–Ω–æ –∏–≥—Ä–æ–∫–æ–≤:', Object.keys(allPlayers).length);
        } else {
            allPlayers = {};
            console.log('–°–æ–∑–¥–∞–Ω–æ –Ω–æ–≤–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –∏–≥—Ä–æ–∫–æ–≤');
        }
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ —Ç–µ–∫—É—â–µ–≥–æ –∏–≥—Ä–æ–∫–∞
        updateCurrentPlayerData();
        
        return true;
    } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–≥—Ä–æ–∫–æ–≤:', error);
        allPlayers = {};
        return false;
    }
}

function updateCurrentPlayerData() {
    if (!gameState) return;
    
    const userId = getUserId();
    const username = getUserName();
    
    allPlayers[userId] = {
        id: userId,
        username: username,
        balance: gameState.balance,
        totalEarned: gameState.totalEarned,
        totalTaps: gameState.totalTaps,
        lastActive: Date.now(),
        skins: gameState.skins,
        isAdmin: gameState.isAdmin,
        referralCode: gameState.referralCode,
        referrals: gameState.referrals,
        version: "1.5"
    };
    
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
    saveAllPlayers();
}

function getUserId() {
    if (tg && tg.initDataUnsafe && tg.initDataUnsafe.user) {
        return tg.initDataUnsafe.user.id.toString();
    }
    return 'guest_' + Math.random().toString(36).substr(2, 9);
}

function getUserName() {
    if (tg && tg.initDataUnsafe && tg.initDataUnsafe.user) {
        return tg.initDataUnsafe.user.first_name || '–ò–≥—Ä–æ–∫';
    }
    return '–ì–æ—Å—Ç—å';
}

// ===== –†–ï–ê–õ–¨–ù–´–ô –¢–û–ü –ò–ì–†–û–ö–û–í =====
function loadRealLeaderboard() {
    // –ó–∞–≥—Ä—É–∂–∞–µ–º –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤
    loadAllPlayers();
    
    // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –æ–±—ä–µ–∫—Ç –∏–≥—Ä–æ–∫–æ–≤ –≤ –º–∞—Å—Å–∏–≤ –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
    const playersArray = Object.values(allPlayers);
    
    // –§–∏–ª—å—Ç—Ä—É–µ–º —Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∏–≥—Ä–æ–∫–æ–≤ (–±—ã–ª–∏ –∞–∫—Ç–∏–≤–Ω—ã –≤ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π)
    const activePlayers = playersArray.filter(player => {
        return Date.now() - player.lastActive < 30 * 24 * 60 * 60 * 1000;
    });
    
    // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ totalEarned (–æ–±—â–µ–º—É –∑–∞—Ä–∞–±–æ—Ç–∫—É)
    const sortedPlayers = activePlayers.sort((a, b) => b.totalEarned - a.totalEarned);
    
    // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º —Ç–æ–ø 50 –∏–≥—Ä–æ–∫–∞–º–∏
    leaderboardData = sortedPlayers.slice(0, 50);
    
    // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ç–æ–ø
    displayRealLeaderboard();
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Ä–∞–Ω–≥ —Ç–µ–∫—É—â–µ–≥–æ –∏–≥—Ä–æ–∫–∞
    updatePlayerRank();
    
    showNotification('üèÜ –¢–æ–ø –∏–≥—Ä–æ–∫–æ–≤ –æ–±–Ω–æ–≤–ª–µ–Ω!');
}

function displayRealLeaderboard() {
    const leaderboardList = document.getElementById('leaderboard-list');
    
    if (leaderboardData.length === 0) {
        leaderboardList.innerHTML = `
            <div style="text-align: center; padding: 20px; color: #888;">
                –ü–æ–∫–∞ –Ω–µ—Ç –∏–≥—Ä–æ–∫–æ–≤ –≤ —Ç–æ–ø–µ.<br>
                –°—Ç–∞–Ω—å—Ç–µ –ø–µ—Ä–≤—ã–º!
            </div>
        `;
        return;
    }
    
    leaderboardList.innerHTML = '';
    
    leaderboardData.slice(0, 20).forEach((player, index) => {
        const rankClass = `rank rank-${index < 3 ? index + 1 : 'other'}`;
        const isCurrentUser = player.id === getUserId();
        const avatarLetter = player.username ? player.username[0].toUpperCase() : '–ò';
        
        const item = document.createElement('div');
        item.className = 'leaderboard-item';
        item.innerHTML = `
            <div class="${rankClass}">${index + 1}</div>
            <div class="player-info">
                <div class="player-name">
                    ${player.username} 
                    ${isCurrentUser ? '<span style="color: #f39c12;">(–í—ã)</span>' : ''}
                    ${player.isAdmin ? ' <span style="color: #e74c3c; font-size: 10px;">[ADMIN]</span>' : ''}
                </div>
                <div style="font-size: 11px; color: #888;">
                    –¢–∞–ø–æ–≤: ${player.totalTaps ? player.totalTaps.toLocaleString() : '0'}
                </div>
            </div>
            <div class="player-score">${player.totalEarned ? player.totalEarned.toLocaleString() : '0'}</div>
            <div class="player-avatar">${avatarLetter}</div>
        `;
        leaderboardList.appendChild(item);
    });
    
    // –ï—Å–ª–∏ –∏–≥—Ä–æ–∫–æ–≤ –±–æ–ª—å—à–µ 20, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–∫–æ–ª—å–∫–æ –≤—Å–µ–≥–æ
    if (leaderboardData.length > 20) {
        const moreItem = document.createElement('div');
        moreItem.style.textAlign = 'center';
        moreItem.style.padding = '10px';
        moreItem.style.color = '#888';
        moreItem.style.fontSize = '12px';
        moreItem.innerHTML = `... –∏ –µ—â–µ ${leaderboardData.length - 20} –∏–≥—Ä–æ–∫–æ–≤`;
        leaderboardList.appendChild(moreItem);
    }
}

function updatePlayerRank() {
    const userId = getUserId();
    const playerIndex = leaderboardData.findIndex(player => player.id === userId);
    
    if (playerIndex !== -1) {
        document.getElementById('player-rank').textContent = `#${playerIndex + 1}`;
    } else {
        // –ï—Å–ª–∏ –∏–≥—Ä–æ–∫ –Ω–µ –≤ —Ç–æ–ø–µ, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –µ–≥–æ –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–æ–µ –º–µ—Å—Ç–æ
        const allPlayersArray = Object.values(allPlayers);
        const sortedAllPlayers = allPlayersArray.sort((a, b) => b.totalEarned - a.totalEarned);
        const allPlayerIndex = sortedAllPlayers.findIndex(player => player.id === userId);
        
        if (allPlayerIndex !== -1) {
            document.getElementById('player-rank').textContent = `#${allPlayerIndex + 1}`;
        } else {
            document.getElementById('player-rank').textContent = '#-';
        }
    }
}

// ===== –û–°–ù–û–í–ù–û–ô –û–ë–™–ï–ö–¢ –°–û–°–¢–û–Ø–ù–ò–Ø –ò–ì–†–´ =====
function createDefaultState() {
    return {
        balance: 0,
        energy: 1000,
        maxEnergy: 1000,
        clickValue: 1,
        multitapCost: 100,
        energyCost: 500,
        autoclickerCost: 2000,
        autoclickerLevel: 0,
        version: "1.5",
        totalTaps: 0,
        totalEarned: 0,
        sessionStart: Date.now(),
        referrals: [],
        referralCode: null,
        dailyRewardLastClaim: 0,
        dailyRewardStreak: 0,
        isAdmin: false,
        lastClickTime: 0,
        lastSaveTime: 0,
        purchases: {
            multitap: 0,
            energy: 0,
            autoclicker: 0
        },
        skins: {
            owned: ['classic'],
            equipped: 'classic'
        }
    };
}

// ===== –°–ò–°–¢–ï–ú–ê –°–û–•–†–ê–ù–ï–ù–ò–Ø =====
function saveGame() {
    if (!gameState) return;
    
    try {
        gameState.lastSaveTime = Date.now();
        const saveData = JSON.stringify(gameState);
        localStorage.setItem('anatoly_coin_save', saveData);
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –∏–≥—Ä–æ–∫–∞ –≤ –æ–±—â–µ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
        updateCurrentPlayerData();
        
        console.log('–ò–≥—Ä–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞:', {
            –±–∞–ª–∞–Ω—Å: gameState.balance,
            –∏–≥—Ä–æ–∫: getUserName(),
            –≤—Ä–µ–º—è: new Date().toLocaleTimeString()
        });
        
        return true;
    } catch (error) {
        console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:', error);
        showNotification('‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è');
        return false;
    }
}

function loadGame() {
    try {
        const saved = localStorage.getItem('anatoly_coin_save');
        
        if (saved) {
            const loadedState = JSON.parse(saved);
            
            if (loadedState.version === "1.5") {
                gameState = loadedState;
                console.log('–ò–≥—Ä–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –∏–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è');
                return true;
            } else {
                // –ú–∏–≥—Ä–∞—Ü–∏—è —Å–æ —Å—Ç–∞—Ä–æ–π –≤–µ—Ä—Å–∏–∏
                gameState = createDefaultState();
                if (loadedState.balance) gameState.balance = loadedState.balance;
                if (loadedState.totalTaps) gameState.totalTaps = loadedState.totalTaps;
                if (loadedState.totalEarned) gameState.totalEarned = loadedState.totalEarned;
                if (loadedState.skins) gameState.skins = loadedState.skins;
                console.log('–ú–∏–≥—Ä–∞—Ü–∏—è —Å –≤–µ—Ä—Å–∏–∏', loadedState.version);
            }
        } else {
            gameState = createDefaultState();
            console.log('–°–æ–∑–¥–∞–Ω–æ –Ω–æ–≤–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ');
        }
        
        return false;
    } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:', error);
        gameState = createDefaultState();
        showNotification('‚ö†Ô∏è –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏, —Å–æ–∑–¥–∞–Ω–æ –Ω–æ–≤–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ');
        return false;
    }
}

function autoSave() {
    if (!gameState || Date.now() - gameState.lastSaveTime < 1000) return;
    saveGame();
}

// ===== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ò–ì–†–´ =====
function initGame() {
    if (tg && tg.initDataUnsafe && tg.initDataUnsafe.user) {
        console.log('Telegram WebApp –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
    } else {
        console.log('–†–µ–∂–∏–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (–Ω–µ –≤ Telegram)');
    }
    
    loadGame();
    loadAllPlayers(); // –ó–∞–≥—Ä—É–∂–∞–µ–º –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤
    
    if (!gameState.referralCode) {
        gameState.referralCode = generateReferralCode();
    }
    
    initDOM();
    updateUI();
    updateAdminBadge();
    loadSkinsShop();
    applySkin(gameState.skins.equipped);
    
    startGameProcesses();
    
    // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ä–µ–∞–ª—å–Ω—ã–π —Ç–æ–ø –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
    setTimeout(() => {
        loadRealLeaderboard();
        showNotification('–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ Anatoly Coin! üéÆ');
    }, 1000);
}

function initDOM() {
    const coin = document.getElementById('coin');
    
    coin.addEventListener('click', handleCoinClick);
    
    coin.addEventListener('touchstart', function(e) {
        e.preventDefault();
        const rect = this.getBoundingClientRect();
        const x = rect.left + rect.width / 2;
        const y = rect.top + rect.height / 2;
        handleTap(x, y);
    }, { passive: false });
    
    document.getElementById('adminCodeInput').addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
            checkAdminCode();
        }
    });
    
    window.addEventListener('beforeunload', function(e) {
        saveGame();
        saveAllPlayers();
    });
    
    setInterval(autoSave, 30000);
    
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            saveGame();
            saveAllPlayers();
        }
    });
}

function startGameProcesses() {
    setInterval(function() {
        if (gameState && gameState.energy < gameState.maxEnergy) {
            gameState.energy = Math.min(gameState.energy + 2, gameState.maxEnergy);
            updateUI();
        }
    }, 1000);
    
    if (gameState.autoclickerLevel > 0) {
        startAutoClicker();
    }
}

// ===== –°–ò–°–¢–ï–ú–ê –°–ö–ò–ù–û–í =====
function loadSkinsShop() {
    const skinsGrid = document.getElementById('skins-grid');
    skinsGrid.innerHTML = '';
    
    skinsData.forEach(skin => {
        const isOwned = gameState.skins.owned.includes(skin.id);
        const isEquipped = gameState.skins.equipped === skin.id;
        const canAfford = gameState.balance >= skin.price;
        
        const skinCard = document.createElement('div');
        skinCard.className = `skin-card ${isEquipped ? 'equipped' : ''} ${!isOwned ? 'locked' : ''}`;
        skinCard.onclick = () => handleSkinClick(skin.id);
        
        const skinStyle = isOwned ? 
            `background: ${skin.color1}; border: 3px solid ${skin.borderColor};` :
            `background: linear-gradient(45deg, #333, #555); border: 3px solid #666;`;
        
        const effectClass = isOwned && skin.effect !== 'none' ? `skin-effect-${skin.effect}` : '';
        
        skinCard.innerHTML = `
            <div class="skin-preview ${effectClass}" style="${skinStyle}">
                ${skin.letter}
            </div>
            <div class="skin-name">${skin.name}</div>
            ${isOwned ? 
                `<div class="skin-owned">${isEquipped ? '–≠–∫–∏–ø–∏—Ä–æ–≤–∞–Ω' : '–ö—É–ø–ª–µ–Ω'}</div>` :
                `<div class="skin-price" style="${canAfford ? 'color: #2ecc71' : 'color: #e74c3c'}">${skin.price.toLocaleString()} –ê–Ω–∞—Ç–æ–ª–∏–π</div>`
            }
            <div class="skin-bonus">+${skin.bonus}% –∫ –¥–æ—Ö–æ–¥—É</div>
        `;
        
        skinsGrid.appendChild(skinCard);
    });
    
    updateCurrentSkinInfo();
}

function updateCurrentSkinInfo() {
    const currentSkin = skinsData.find(s => s.id === gameState.skins.equipped);
    if (currentSkin) {
        document.getElementById('current-skin-name').textContent = currentSkin.name;
        document.getElementById('current-skin-bonus').textContent = `+${currentSkin.bonus}% –∫ –¥–æ—Ö–æ–¥—É`;
    }
}

function handleSkinClick(skinId) {
    const skin = skinsData.find(s => s.id === skinId);
    
    if (!skin) return;
    
    const isOwned = gameState.skins.owned.includes(skinId);
    
    if (!isOwned) {
        if (gameState.balance >= skin.price) {
            gameState.balance -= skin.price;
            gameState.skins.owned.push(skinId);
            gameState.skins.equipped = skinId;
            
            showNotification(`‚úÖ –°–∫–∏–Ω "${skin.name}" –∫—É–ø–ª–µ–Ω –∏ —ç–∫–∏–ø–∏—Ä–æ–≤–∞–Ω!`);
            updateUI();
            loadSkinsShop();
            applySkin(skinId);
            autoSave();
        } else {
            showNotification(`‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç –¥–ª—è –ø–æ–∫—É–ø–∫–∏ "${skin.name}"!`);
        }
    } else {
        gameState.skins.equipped = skinId;
        showNotification(`‚úÖ –°–∫–∏–Ω "${skin.name}" —ç–∫–∏–ø–∏—Ä–æ–≤–∞–Ω!`);
        loadSkinsShop();
        applySkin(skinId);
        autoSave();
    }
}

function applySkin(skinId) {
    const skin = skinsData.find(s => s.id === skinId);
    if (!skin) return;
    
    const coin = document.getElementById('coin');
    const coinEffect = document.getElementById('coin-effect');
    const coinLetter = document.getElementById('coin-letter');
    
    coin.style.background = `radial-gradient(circle, ${skin.color1}, ${skin.color2})`;
    coin.style.borderColor = skin.borderColor;
    coinLetter.textContent = skin.letter;
    
    coinEffect.className = 'coin-effect';
    if (skin.effect !== 'none') {
        coinEffect.classList.add(`skin-effect-${skin.effect}`);
        
        if (skin.effect === 'rainbow') {
            coinEffect.style.background = skin.color1;
            coinEffect.style.backgroundSize = '400% 400%';
        } else if (skin.effect === 'glow') {
            coinEffect.style.boxShadow = `0 0 30px ${skin.borderColor}`;
        }
    }
    
    updateCurrentSkinInfo();
}

function getSkinBonus() {
    const currentSkin = skinsData.find(s => s.id === gameState.skins.equipped);
    return currentSkin ? currentSkin.bonus : 0;
}

function calculateClickValue() {
    const baseValue = gameState.clickValue;
    const skinBonus = getSkinBonus();
    const bonusMultiplier = 1 + (skinBonus / 100);
    return Math.floor(baseValue * bonusMultiplier);
}

// ===== –û–°–ù–û–í–ù–´–ï –ò–ì–†–û–í–´–ï –§–£–ù–ö–¶–ò–ò =====
function handleCoinClick(e) {
    const now = Date.now();
    if (now - gameState.lastClickTime < 50) return;
    gameState.lastClickTime = now;
    
    const rect = e.currentTarget.getBoundingClientRect();
    const x = rect.left + rect.width / 2;
    const y = rect.top + rect.height / 2;
    handleTap(x, y);
}

function handleTap(x, y) {
    if (gameState.energy >= gameState.clickValue) {
        const actualClickValue = calculateClickValue();
        
        gameState.balance += actualClickValue;
        gameState.energy -= gameState.clickValue;
        gameState.totalTaps++;
        gameState.totalEarned += actualClickValue;
        
        updateUI();
        createTapAnimation(x, y, actualClickValue);
        
        if (gameState.totalTaps % 10 === 0) {
            autoSave();
        }
        
        updateTaskProgress();
        
        if (tg && tg.HapticFeedback) {
            try {
                tg.HapticFeedback.impactOccurred('light');
            } catch (e) {}
        }
    } else {
        createNoEnergyAnimation(x, y);
    }
}

function createTapAnimation(x, y, value) {
    const el = document.createElement('div');
    el.className = 'tap-number';
    el.innerText = `+${value}`;
    el.style.left = `${x - 30}px`;
    el.style.top = `${y - 30}px`;
    document.body.appendChild(el);
    setTimeout(() => el.remove(), 800);
}

function createNoEnergyAnimation(x, y) {
    const el = document.createElement('div');
    el.className = 'tap-number';
    el.innerText = `‚ö° –ù–µ—Ç —ç–Ω–µ—Ä–≥–∏–∏!`;
    el.style.color = '#e74c3c';
    el.style.left = `${x - 50}px`;
    el.style.top = `${y - 30}px`;
    document.body.appendChild(el);
    setTimeout(() => el.remove(), 800);
}

// ===== –§–£–ù–ö–¶–ò–ò –ë–£–°–¢–û–í =====
function buyMultitap() {
    if (gameState.balance >= gameState.multitapCost) {
        gameState.balance -= gameState.multitapCost;
        gameState.clickValue += 1;
        gameState.multitapCost = Math.floor(gameState.multitapCost * 1.5);
        gameState.purchases.multitap++;
        
        document.getElementById('multitap-price').innerText = gameState.multitapCost;
        updateUI();
        showNotification(`‚úÖ Multitap –∫—É–ø–ª–µ–Ω! –¢–µ–ø–µ—Ä—å –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ +${gameState.clickValue} –∑–∞ –∫–ª–∏–∫`);
        autoSave();
    } else {
        showNotification('‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç!');
    }
}

function buyEnergyLimit() {
    if (gameState.balance >= gameState.energyCost) {
        gameState.balance -= gameState.energyCost;
        gameState.maxEnergy += 500;
        gameState.energy = gameState.maxEnergy;
        gameState.energyCost = Math.floor(gameState.energyCost * 1.8);
        gameState.purchases.energy++;
        
        document.getElementById('energy-price').innerText = gameState.energyCost;
        updateUI();
        showNotification(`‚úÖ –õ–∏–º–∏—Ç —ç–Ω–µ—Ä–≥–∏–∏ —É–≤–µ–ª–∏—á–µ–Ω –¥–æ ${gameState.maxEnergy}!`);
        autoSave();
    } else {
        showNotification('‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç!');
    }
}

function buyAutoClicker() {
    if (gameState.balance >= gameState.autoclickerCost) {
        gameState.balance -= gameState.autoclickerCost;
        gameState.autoclickerLevel++;
        gameState.autoclickerCost = Math.floor(gameState.autoclickerCost * 2);
        gameState.purchases.autoclicker++;
        
        document.getElementById('autoclicker-price').innerText = gameState.autoclickerCost;
        updateUI();
        showNotification(`‚úÖ –ê–≤—Ç–æ–∫–ª–∏–∫–µ—Ä –∫—É–ø–ª–µ–Ω! –£—Ä–æ–≤–µ–Ω—å: ${gameState.autoclickerLevel}`);
        autoSave();
        
        if (gameState.autoclickerLevel === 1) {
            startAutoClicker();
        }
    } else {
        showNotification('‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç!');
    }
}

function startAutoClicker() {
    setInterval(() => {
        if (gameState.energy >= gameState.clickValue) {
            const actualClickValue = calculateClickValue();
            gameState.balance += actualClickValue;
            gameState.energy -= gameState.clickValue;
            gameState.totalEarned += actualClickValue;
            updateUI();
            
            if (gameState.totalTaps % 50 === 0) {
                autoSave();
            }
        }
    }, 1000);
}

// ===== –§–£–ù–ö–¶–ò–ò –ó–ê–î–ê–ù–ò–ô =====
function completeTask(reward, el, url) {
    gameState.balance += reward;
    gameState.totalEarned += reward;
    updateUI();
    
    if (el) {
        el.style.background = 'linear-gradient(45deg, #27ae60, #2ecc71)';
        el.innerHTML = '<div style="color: white; font-weight: bold;">‚úÖ –ó–∞–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ!</div>';
        setTimeout(() => {
            el.style.display = 'none';
        }, 1000);
    }
    
    if (url) {
        window.open(url, '_blank');
    }
    
    showNotification(`üéâ +${reward.toLocaleString()} –º–æ–Ω–µ—Ç!`);
    autoSave();
}

function updateTaskProgress() {
    const progress = document.getElementById('taps-progress');
    if (progress) {
        const tapsToday = gameState.totalTaps % 100;
        progress.textContent = `–ü—Ä–æ–≥—Ä–µ—Å—Å: ${tapsToday}/100`;
        
        if (tapsToday === 100) {
            showNotification('‚úÖ 100 —Ç–∞–ø–æ–≤ –∑–∞ –¥–µ–Ω—å –≤—ã–ø–æ–ª–Ω–µ–Ω–æ!');
        }
    }
}

// ===== –ê–î–ú–ò–ù-–ü–ê–ù–ï–õ–¨ =====
function showAdminCodeModal() {
    document.getElementById('codeModal').classList.add('active');
    document.getElementById('adminOverlay').classList.add('active');
    setTimeout(() => {
        document.getElementById('adminCodeInput').focus();
    }, 100);
}

function checkAdminCode() {
    const codeInput = document.getElementById('adminCodeInput');
    const code = codeInput.value.trim();
    
    if (code === 'carapizzz1399' || code === 'admin123') {
        gameState.isAdmin = true;
        showNotification('‚úÖ –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞!');
        updateAdminBadge();
        showAdminPanel();
        autoSave();
    } else {
        showNotification('‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –∫–æ–¥!');
        codeInput.value = '';
        codeInput.focus();
    }
}

function updateAdminBadge() {
    const currencyLabel = document.querySelector('.currency-label');
    if (gameState.isAdmin) {
        currencyLabel.innerHTML = '–í–ê–õ–Æ–¢–ê –ê–ù–ê–¢–û–õ–ò–ô <span class="admin-badge">ADMIN</span>';
    } else {
        currencyLabel.innerHTML = '–í–ê–õ–Æ–¢–ê –ê–ù–ê–¢–û–õ–ò–ô';
    }
}

function showAdminPanel() {
    closeAdminCodeModal();
    document.getElementById('adminPanel').classList.add('active');
    document.getElementById('adminOverlay').classList.add('active');
    document.getElementById('currentBalanceAdmin').textContent = gameState.balance.toLocaleString();
    
    // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
    loadPlayersForAdmin();
    loadSkinsForAdmin();
}

function closeAdminCodeModal() {
    document.getElementById('codeModal').classList.remove('active');
    document.getElementById('adminOverlay').classList.remove('active');
}

function closeAdminPanel() {
    document.getElementById('adminPanel').classList.remove('active');
    document.getElementById('adminOverlay').classList.remove('active');
}

function showAdminTab(tabName) {
    // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–µ —Ç–∞–±—ã
    document.querySelectorAll('.admin-tab').forEach(tab => tab.classList.remove('active'));
    document.querySelectorAll('.admin-tab-content').forEach(content => content.style.display = 'none');
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ç–∞–±
    if (tabName === 'main') {
        document.querySelector('.admin-tab:nth-child(1)').classList.add('active');
        document.getElementById('admin-tab-main').style.display = 'block';
    } else if (tabName === 'players') {
        document.querySelector('.admin-tab:nth-child(2)').classList.add('active');
        document.getElementById('admin-tab-players').style.display = 'block';
        loadPlayersForAdmin();
    } else if (tabName === 'skins') {
        document.querySelector('.admin-tab:nth-child(3)').classList.add('active');
        document.getElementById('admin-tab-skins').style.display = 'block';
        loadSkinsForAdmin();
    }
}

// ===== –£–ü–†–ê–í–õ–ï–ù–ò–ï –ò–ì–†–û–ö–ê–ú–ò –í –ê–î–ú–ò–ù-–ü–ê–ù–ï–õ–ò =====
function loadPlayersForAdmin() {
    loadAllPlayers();
    
    const playersList = document.getElementById('players-list');
    playersList.innerHTML = '';
    
    const playersArray = Object.values(allPlayers);
    
    // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –ø–æ—Å–ª–µ–¥–Ω–µ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
    const sortedPlayers = playersArray.sort((a, b) => b.lastActive - a.lastActive);
    
    sortedPlayers.forEach((player, index) => {
        const playerItem = document.createElement('div');
        playerItem.className = 'player-admin-item';
        playerItem.innerHTML = `
            <div class="player-admin-info">
                <div class="player-admin-name">
                    ${player.username || '–ë–µ–∑ –∏–º–µ–Ω–∏'}
                    ${player.isAdmin ? ' <span style="color: #e74c3c; font-size: 10px;">[ADMIN]</span>' : ''}
                </div>
                <div class="player-admin-balance">
                    –ë–∞–ª–∞–Ω—Å: ${player.balance ? player.balance.toLocaleString() : '0'} –º–æ–Ω–µ—Ç
                </div>
                <div style="font-size: 10px; color: #888;">
                    ID: ${player.id} | –¢–∞–ø–æ–≤: ${player.totalTaps ? player.totalTaps.toLocaleString() : '0'}
                </div>
            </div>
            <div class="player-admin-actions">
                <button class="admin-action-btn" onclick="adminAddCoins('${player.id}', 1000)">+1–∫</button>
                <button class="admin-action-btn" onclick="adminAddCoins('${player.id}', 10000)">+10–∫</button>
                <button class="admin-action-btn" onclick="adminAddCoins('${player.id}', 100000)">+100–∫</button>
                <button class="admin-action-btn" onclick="adminResetPlayer('${player.id}')" style="background: #e74c3c;">–°–±—Ä–æ—Å</button>
            </div>
        `;
        playersList.appendChild(playerItem);
    });
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
    updateAdminStats();
}

function searchPlayers() {
    const searchTerm = document.getElementById('playerSearch').value.toLowerCase();
    const playersList = document.getElementById('players-list');
    const playersArray = Object.values(allPlayers);
    
    playersList.innerHTML = '';
    
    const filteredPlayers = playersArray.filter(player => {
        const username = (player.username || '').toLowerCase();
        const id = (player.id || '').toLowerCase();
        return username.includes(searchTerm) || id.includes(searchTerm);
    });
    
    filteredPlayers.forEach((player, index) => {
        const playerItem = document.createElement('div');
        playerItem.className = 'player-admin-item';
        playerItem.innerHTML = `
            <div class="player-admin-info">
                <div class="player-admin-name">
                    ${player.username || '–ë–µ–∑ –∏–º–µ–Ω–∏'}
                    ${player.isAdmin ? ' <span style="color: #e74c3c; font-size: 10px;">[ADMIN]</span>' : ''}
                </div>
                <div class="player-admin-balance">
                    –ë–∞–ª–∞–Ω—Å: ${player.balance ? player.balance.toLocaleString() : '0'} –º–æ–Ω–µ—Ç
                </div>
                <div style="font-size: 10px; color: #888;">
                    ID: ${player.id} | –¢–∞–ø–æ–≤: ${player.totalTaps ? player.totalTaps.toLocaleString() : '0'}
                </div>
            </div>
            <div class="player-admin-actions">
                <button class="admin-action-btn" onclick="adminAddCoins('${player.id}', 1000)">+1–∫</button>
                <button class="admin-action-btn" onclick="adminAddCoins('${player.id}', 10000)">+10–∫</button>
                <button class="admin-action-btn" onclick="adminAddCoins('${player.id}', 100000)">+100–∫</button>
                <button class="admin-action-btn" onclick="adminResetPlayer('${player.id}')" style="background: #e74c3c;">–°–±—Ä–æ—Å</button>
            </div>
        `;
        playersList.appendChild(playerItem);
    });
}

function updateAdminStats() {
    const playersArray = Object.values(allPlayers);
    const totalPlayers = playersArray.length;
    const totalBalance = playersArray.reduce((sum, player) => sum + (player.balance || 0), 0);
    
    document.getElementById('total-players').textContent = totalPlayers;
    document.getElementById('total-balance').textContent = totalBalance.toLocaleString();
}

function adminAddCoins(playerId, amount) {
    if (!gameState.isAdmin) {
        showNotification('‚ùå –ù–µ—Ç –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞!');
        return;
    }
    
    if (!allPlayers[playerId]) {
        showNotification('‚ùå –ò–≥—Ä–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω!');
        return;
    }
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å –∏–≥—Ä–æ–∫–∞
    allPlayers[playerId].balance = (allPlayers[playerId].balance || 0) + amount;
    allPlayers[playerId].totalEarned = (allPlayers[playerId].totalEarned || 0) + amount;
    
    // –ï—Å–ª–∏ —ç—Ç–æ —Ç–µ–∫—É—â–∏–π –∏–≥—Ä–æ–∫, –æ–±–Ω–æ–≤–ª—è–µ–º –µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    if (playerId === getUserId()) {
        gameState.balance += amount;
        gameState.totalEarned += amount;
        updateUI();
    }
    
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
    saveAllPlayers();
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤
    loadPlayersForAdmin();
    
    showNotification(`‚úÖ –ò–≥—Ä–æ–∫—É ${allPlayers[playerId].username} –¥–æ–±–∞–≤–ª–µ–Ω–æ ${amount.toLocaleString()} –º–æ–Ω–µ—Ç!`);
}

function adminResetPlayer(playerId) {
    if (!gameState.isAdmin) {
        showNotification('‚ùå –ù–µ—Ç –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞!');
        return;
    }
    
    if (!allPlayers[playerId]) {
        showNotification('‚ùå –ò–≥—Ä–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω!');
        return;
    }
    
    if (confirm(`–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —Å–±—Ä–æ—Å–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –∏–≥—Ä–æ–∫–∞ ${allPlayers[playerId].username}?`)) {
        // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –∏–≥—Ä–æ–∫–∞
        allPlayers[playerId] = {
            ...allPlayers[playerId],
            balance: 0,
            totalEarned: 0,
            totalTaps: 0,
            skins: {
                owned: ['classic'],
                equipped: 'classic'
            },
            isAdmin: playerId === getUserId() // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∞–¥–º–∏–Ω—Å–∫–∏–µ –ø—Ä–∞–≤–∞ –¥–ª—è —Å–µ–±—è
        };
        
        // –ï—Å–ª–∏ —ç—Ç–æ —Ç–µ–∫—É—â–∏–π –∏–≥—Ä–æ–∫, –æ–±–Ω–æ–≤–ª—è–µ–º –µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
        if (playerId === getUserId()) {
            gameState.balance = 0;
            gameState.totalEarned = 0;
            gameState.totalTaps = 0;
            gameState.skins = {
                owned: ['classic'],
                equipped: 'classic'
            };
            updateUI();
            loadSkinsShop();
            applySkin('classic');
        }
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
        saveAllPlayers();
        
        // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤
        loadPlayersForAdmin();
        
        showNotification(`‚úÖ –ü—Ä–æ–≥—Ä–µ—Å—Å –∏–≥—Ä–æ–∫–∞ ${allPlayers[playerId].username} —Å–±—Ä–æ—à–µ–Ω!`);
    }
}

function giveCoinsToPlayer() {
    const playerId = document.getElementById('playerIdInput').value.trim();
    const amount = parseInt(document.getElementById('playerCoinsAmount').value);
    
    if (!playerId) {
        showNotification('‚ùå –í–≤–µ–¥–∏—Ç–µ ID –∏–≥—Ä–æ–∫–∞!');
        return;
    }
    
    if (isNaN(amount) || amount <= 0) {
        showNotification('‚ùå –í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–æ–Ω–µ—Ç!');
        return;
    }
    
    adminAddCoins(playerId, amount);
    
    // –û—á–∏—â–∞–µ–º –ø–æ–ª—è
    document.getElementById('playerIdInput').value = '';
    document.getElementById('playerCoinsAmount').value = '';
}

// ===== –£–ü–†–ê–í–õ–ï–ù–ò–ï –°–ö–ò–ù–ê–ú–ò –í –ê–î–ú–ò–ù-–ü–ê–ù–ï–õ–ò =====
function loadSkinsForAdmin() {
    const skinsGrid = document.getElementById('admin-skins-grid');
    const skinSelect = document.getElementById('skinSelect');
    
    skinsGrid.innerHTML = '';
    skinSelect.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Å–∫–∏–Ω</option>';
    
    skinsData.forEach(skin => {
        // –î–æ–±–∞–≤–ª—è–µ–º –≤ —Å–µ—Ç–∫—É
        const skinCard = document.createElement('div');
        skinCard.className = 'skin-admin-card';
        skinCard.onclick = () => selectSkinForAdmin(skin.id);
        skinCard.innerHTML = `
            <div class="skin-admin-preview" style="background: ${skin.color1}; border: 2px solid ${skin.borderColor};">
                ${skin.letter}
            </div>
            <div style="font-size: 12px; font-weight: bold;">${skin.name}</div>
            <div style="font-size: 10px; color: #888;">+${skin.bonus}%</div>
        `;
        skinsGrid.appendChild(skinCard);
        
        // –î–æ–±–∞–≤–ª—è–µ–º –≤ –≤—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫
        const option = document.createElement('option');
        option.value = skin.id;
        option.textContent = `${skin.name} (+${skin.bonus}%)`;
        skinSelect.appendChild(option);
    });
}

let selectedSkinForAdmin = null;

function selectSkinForAdmin(skinId) {
    selectedSkinForAdmin = skinId;
    document.getElementById('skinSelect').value = skinId;
    
    // –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Å–∫–∏–Ω
    document.querySelectorAll('.skin-admin-card').forEach(card => {
        card.style.border = '2px solid transparent';
    });
    
    const selectedCard = document.querySelector(`.skin-admin-card:nth-child(${skinsData.findIndex(s => s.id === skinId) + 1})`);
    if (selectedCard) {
        selectedCard.style.border = '2px solid var(--main-gold)';
    }
}

function giveSkinToPlayer() {
    const playerId = document.getElementById('skinPlayerId').value.trim();
    const skinId = document.getElementById('skinSelect').value;
    
    if (!playerId) {
        showNotification('‚ùå –í–≤–µ–¥–∏—Ç–µ ID –∏–≥—Ä–æ–∫–∞!');
        return;
    }
    
    if (!skinId) {
        showNotification('‚ùå –í—ã–±–µ—Ä–∏—Ç–µ —Å–∫–∏–Ω!');
        return;
    }
    
    if (!gameState.isAdmin) {
        showNotification('‚ùå –ù–µ—Ç –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞!');
        return;
    }
    
    if (!allPlayers[playerId]) {
        showNotification('‚ùå –ò–≥—Ä–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω!');
        return;
    }
    
    const skin = skinsData.find(s => s.id === skinId);
    if (!skin) {
        showNotification('‚ùå –°–∫–∏–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω!');
        return;
    }
    
    // –î–æ–±–∞–≤–ª—è–µ–º —Å–∫–∏–Ω –∏–≥—Ä–æ–∫—É
    if (!allPlayers[playerId].skins) {
        allPlayers[playerId].skins = {
            owned: ['classic'],
            equipped: 'classic'
        };
    }
    
    if (!allPlayers[playerId].skins.owned.includes(skinId)) {
        allPlayers[playerId].skins.owned.push(skinId);
    }
    
    // –ï—Å–ª–∏ —ç—Ç–æ —Ç–µ–∫—É—â–∏–π –∏–≥—Ä–æ–∫, –æ–±–Ω–æ–≤–ª—è–µ–º –µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    if (playerId === getUserId()) {
        if (!gameState.skins.owned.includes(skinId)) {
            gameState.skins.owned.push(skinId);
        }
        loadSkinsShop();
    }
    
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
    saveAllPlayers();
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤
    loadPlayersForAdmin();
    
    showNotification(`‚úÖ –ò–≥—Ä–æ–∫—É ${allPlayers[playerId].username} –≤—ã–¥–∞–Ω —Å–∫–∏–Ω "${skin.name}"!`);
    
    // –û—á–∏—â–∞–µ–º –ø–æ–ª—è
    document.getElementById('skinPlayerId').value = '';
    document.getElementById('skinSelect').value = '';
    selectedSkinForAdmin = null;
}

function unlockAllSkins() {
    if (!gameState.isAdmin) {
        showNotification('‚ùå –ù–µ—Ç –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞!');
        return;
    }
    
    if (confirm('–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –í–°–ï —Å–∫–∏–Ω—ã –¥–ª—è —Å–µ–±—è? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.')) {
        // –†–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º –≤—Å–µ —Å–∫–∏–Ω—ã
        gameState.skins.owned = skinsData.map(skin => skin.id);
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
        autoSave();
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –º–∞–≥–∞–∑–∏–Ω
        loadSkinsShop();
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ –æ–±—â–µ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
        updateCurrentPlayerData();
        
        showNotification('‚úÖ –í—Å–µ —Å–∫–∏–Ω—ã —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã!');
    }
}

function addAdminCoins() {
    const amountInput = document.getElementById('adminCoinsAmount');
    const amount = parseInt(amountInput.value);
    
    if (isNaN(amount) || amount <= 0) {
        showNotification('‚ùå –í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ!');
        return;
    }
    
    gameState.balance += amount;
    gameState.totalEarned += amount;
    updateUI();
    autoSave();
    
    amountInput.value = '';
    document.getElementById('currentBalanceAdmin').textContent = gameState.balance.toLocaleString();
    showNotification(`‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ ${amount.toLocaleString()} –º–æ–Ω–µ—Ç!`);
}

function addCoins(amount) {
    gameState.balance += amount;
    gameState.totalEarned += amount;
    updateUI();
    autoSave();
    
    document.getElementById('adminCoinsAmount').value = '';
    document.getElementById('currentBalanceAdmin').textContent = gameState.balance.toLocaleString();
    showNotification(`‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ ${amount.toLocaleString()} –º–æ–Ω–µ—Ç!`);
}

function resetEnergy() {
    gameState.energy = gameState.maxEnergy;
    updateUI();
    autoSave();
    showNotification('‚úÖ –≠–Ω–µ—Ä–≥–∏—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞!');
}

function resetGame() {
    if (confirm('–í–ù–ò–ú–ê–ù–ò–ï! –í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —Å–±—Ä–æ—Å–∏—Ç—å –≤—Å—é –∏–≥—Ä—É?\n–í—Å–µ –≤–∞—à–∏ –º–æ–Ω–µ—Ç—ã –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã!')) {
        gameState = createDefaultState();
        gameState.referralCode = generateReferralCode();
        gameState.isAdmin = true;
        
        updateUI();
        loadSkinsShop();
        applySkin('classic');
        saveGame();
        showNotification('üîÑ –ò–≥—Ä–∞ —Å–±—Ä–æ—à–µ–Ω–∞!');
        closeAdminPanel();
    }
}

// ===== –†–ï–§–ï–†–ê–õ–¨–ù–ê–Ø –°–ò–°–¢–ï–ú–ê =====
function generateReferralCode() {
    const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
    let code = '';
    for (let i = 0; i < 8; i++) {
        code += chars.charAt(Math.floor(Math.random() * chars.length));
    }
    return code;
}

function copyReferralCode() {
    const code = `https://t.me/share/url?url=–ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Å—è%20–∫%20Anatoly%20Coin!&text=–ò–≥—Ä–∞–π%20–≤%20Anatoly%20Coin!%20–ò—Å–ø–æ–ª—å–∑—É–π%20–º–æ–π%20–∫–æ–¥:%20${gameState.referralCode}%20–¥–ª—è%20–±–æ–Ω—É—Å–∞!`;
    
    if (navigator.clipboard && navigator.clipboard.writeText) {
        navigator.clipboard.writeText(code).then(() => {
            showNotification('üìã –°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞!');
        }).catch(err => {
            showNotification('‚ùå –û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è');
        });
    } else {
        const textArea = document.createElement('textarea');
        textArea.value = code;
        document.body.appendChild(textArea);
        textArea.select();
        document.execCommand('copy');
        document.body.removeChild(textArea);
        showNotification('üìã –°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞!');
    }
}

// ===== –ï–ñ–ï–î–ù–ï–í–ù–´–ï –ù–ê–ì–†–ê–î–´ =====
function checkDailyReward() {
    const now = Date.now();
    const lastClaim = gameState.dailyRewardLastClaim;
    const oneDay = 24 * 60 * 60 * 1000;
    
    const btn = document.getElementById('daily-reward-btn');
    const timer = document.getElementById('reward-timer');
    
    if (now - lastClaim < oneDay) {
        btn.disabled = true;
        btn.textContent = '–£–∂–µ –ø–æ–ª—É—á–µ–Ω–æ';
        
        const nextClaim = lastClaim + oneDay;
        const timeLeft = nextClaim - now;
        const hours = Math.floor(timeLeft / (1000 * 60 * 60));
        const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
        
        timer.textContent = `–°–ª–µ–¥—É—é—â–∞—è –Ω–∞–≥—Ä–∞–¥–∞ —á–µ—Ä–µ–∑: ${hours}—á ${minutes}–º`;
    } else if (now - lastClaim > oneDay * 2) {
        gameState.dailyRewardStreak = 0;
    }
    
    btn.textContent = `–ó–∞–±—Ä–∞—Ç—å (${gameState.dailyRewardStreak + 1} –¥–µ–Ω—å)`;
}

function claimDailyReward() {
    const reward = 1000 * (gameState.dailyRewardStreak + 1);
    gameState.balance += reward;
    gameState.dailyRewardLastClaim = Date.now();
    gameState.dailyRewardStreak++;
    
    updateUI();
    autoSave();
    checkDailyReward();
    showNotification(`üéÅ –ü–æ–ª—É—á–µ–Ω–æ ${reward.toLocaleString()} –º–æ–Ω–µ—Ç! –°–µ—Ä–∏—è: ${gameState.dailyRewardStreak} –¥–Ω–µ–π`);
}

// ===== –û–ë–ù–û–í–õ–ï–ù–ò–ï –ò–ù–¢–ï–†–§–ï–ô–°–ê =====
function updateUI() {
    if (!gameState) return;
    
    document.getElementById('balance').innerText = gameState.balance.toLocaleString();
    
    const energyPerc = (gameState.energy / gameState.maxEnergy) * 100;
    document.getElementById('energy-fill').style.width = `${energyPerc}%`;
    document.getElementById('energy-text').innerText = `${Math.floor(gameState.energy)} / ${gameState.maxEnergy}`;
    
    const energyFill = document.getElementById('energy-fill');
    if (gameState.energy < gameState.maxEnergy * 0.3) {
        energyFill.style.background = 'linear-gradient(90deg, #e74c3c, #c0392b)';
    } else if (gameState.energy < gameState.maxEnergy * 0.6) {
        energyFill.style.background = 'linear-gradient(90deg, #f39c12, #e67e22)';
    } else {
        energyFill.style.background = 'linear-gradient(90deg, #2ecc71, #27ae60)';
    }
    
    document.getElementById('multitap-price').innerText = gameState.multitapCost;
    document.getElementById('energy-price').innerText = gameState.energyCost;
    document.getElementById('autoclicker-price').innerText = gameState.autoclickerCost;
    
    updateStats();
}

function updateStats() {
    document.getElementById('referral-code').textContent = `–ö–æ–¥: ${gameState.referralCode}`;
    document.getElementById('referral-count').textContent = gameState.referrals.length;
    document.getElementById('total-taps').textContent = gameState.totalTaps.toLocaleString();
    document.getElementById('total-boosts').textContent = (gameState.purchases.multitap + gameState.purchases.energy + gameState.purchases.autoclicker).toLocaleString();
    document.getElementById('session-earned').textContent = calculateSessionEarned().toLocaleString();
}

function calculateSessionEarned() {
    return Math.floor((Date.now() - gameState.sessionStart) / 1000) * 10 + gameState.totalEarned;
}

// ===== –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø =====
function showNotification(text) {
    const existing = document.querySelector('.save-notification');
    if (existing) existing.remove();
    
    const notification = document.createElement('div');
    notification.className = 'save-notification';
    notification.innerHTML = text;
    document.body.appendChild(notification);
    
    setTimeout(() => {
        if (notification.parentNode) {
            notification.remove();
        }
    }, 2000);
}

// ===== –ü–ï–†–ï–ö–õ–Æ–ß–ï–ù–ò–ï –≠–ö–†–ê–ù–û–í –ò –¢–ê–ë–û–í =====
function showScreen(screenId, btn) {
    document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
    document.getElementById(screenId).classList.add('active');
    
    document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active-nav'));
    btn.classList.add('active-nav');
    
    if (screenId === 'top-screen') {
        loadRealLeaderboard();
        checkDailyReward();
    } else if (screenId === 'boosts-screen') {
        loadSkinsShop();
    }
}

function showShopTab(tabName) {
    document.querySelectorAll('.shop-tab').forEach(tab => tab.classList.remove('active'));
    document.querySelectorAll('.shop-tab-content').forEach(content => content.style.display = 'none');
    
    if (tabName === 'boosts') {
        document.querySelector('.shop-tab:nth-child(1)').classList.add('active');
        document.getElementById('boosts-tab').style.display = 'block';
    } else if (tabName === 'skins') {
        document.querySelector('.shop-tab:nth-child(2)').classList.add('active');
        document.getElementById('skins-tab').style.display = 'block';
        loadSkinsShop();
    }
}

// ===== –£–ü–†–ê–í–õ–ï–ù–ò–ï –° –ö–õ–ê–í–ò–ê–¢–£–†–´ =====
document.addEventListener('keydown', function(e) {
    if (e.ctrlKey && e.shiftKey && e.key === 'A') {
        e.preventDefault();
        showAdminCodeModal();
    }
    
    if (e.code === 'Space') {
        e.preventDefault();
        const coin = document.getElementById('coin');
        const rect = coin.getBoundingClientRect();
        const x = rect.left + rect.width / 2;
        const y = rect.top + rect.height / 2;
        handleTap(x, y);
    }
});

// ===== –ó–ê–ü–£–°–ö –ò–ì–†–´ =====
document.addEventListener('DOMContentLoaded', function() {
    initGame();
});

window.addEventListener('load', function() {
    console.log('Anatoly Coin –∑–∞–≥—Ä—É–∂–µ–Ω! –†–µ–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ç–æ–ø–∞ –≤–∫–ª—é—á–µ–Ω–∞.');
});
</script>
</body>
</html>